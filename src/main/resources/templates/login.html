<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <title>User Login</title>
</head>
<body>
<h2>User Login</h2>
<form id="loginForm" method="post">
  <label for="email">Email:</label>
  <input type="email" id="email" name="email" required>
  <br>
  <label for="otp">OTP:</label>
  <input type="text" id="otp" name="otp" required>
  <br>
  <button type="button" onclick="sendOTP()">Send OTP</button>
  <button type="button" onclick="loginUser()">Verify & Login</button>
</form>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
  function sendOTP() {
    var email = $('#email').val();
    $.post('/api/sendotp', { email: email })
            .done(function(response) {
              alert('OTP sent to your email. Please check and enter.');
            })
            .fail(function(error) {
              alert('Failed to send OTP. Please try again later.');
            });
  }

  function loginUser() {
    var email = $('#email').val();
    var otp = $('#otp').val();
    $.post('/api/login', { email: email, otp: otp })
            .done(function(response) {
              alert('Login successful!');
              // Redirect or perform actions upon successful login
            })
            .fail(function(error) {
              alert('Login failed. Invalid email or OTP.');
            });
  }
</script>
</body>
</html>
